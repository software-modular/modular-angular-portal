<div class="projects-register-container">
  <div class="projects-register-body-container">
    <div class="projects-register-body-content">
      <div class="row">
        <div class="col-md-12">
          <span class="back-button">
            <button class="btn btn-secundary" [routerLink]="'/portal/project/management'">
              <i class="fa fa-chevron-left" aria-hidden="true"> </i>
              &nbsp;&nbsp;Atras
            </button>
          </span>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 section-container-left">
          <agrapp-projects-card [data]="cardData"></agrapp-projects-card>
        </div>
        <div class="col-md-6 section-container-right">
          <div class="project-register-form-container">
            <mat-stepper class="project-register-step-container" labelPosition="bottom" #stepper>
              <mat-step [stepControl]="form">
                <form [formGroup]="form" class="project-register-form">
                  <ng-template matStepLabel>Proyecto</ng-template>
                  <div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="projectName" [label]="'Nombre'" />
                        <mat-error class="error-field" *ngIf="form.get('projectName')?.invalid
                        && (form.get('projectName')?.dirty
                        || form.get('projectName')?.touched)">
                          <label *ngIf="form.get('projectName')?.hasError('required')">El campo es obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text-area formControlName="projectDescription" [label]="'Descripción'"></input-text-area>
                        <mat-error class="error-field" *ngIf="form.get('projectDescription')?.invalid
                        && (form.get('projectDescription')?.dirty
                        || form.get('projectDescription')?.touched)">
                          <label *ngIf="form.get('projectDescription')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-multi-radio-check formControlName="projectHasPrePurchase"
                          [label]="'Pre-compra'"></input-multi-radio-check>
                        <mat-error class="error-field" *ngIf="form.get('projectHasPrePurchase')?.invalid
                          && (form.get('projectHasPrePurchase')?.dirty
                          || form.get('projectHasPrePurchase')?.touched)">
                          <label *ngIf="form.get('projectHasPrePurchase')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="projectStartDate" [label]="'Fecha inicio'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('projectStartDate')?.invalid
                        && (form.get('projectStartDate')?.dirty
                        || form.get('projectStartDate')?.touched)">
                          <label *ngIf="form.get('projectStartDate')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="projectEndDate" [label]="'Fecha fin'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('projectDescription')?.invalid
                        && (form.get('projectEndDate')?.dirty
                        || form.get('projectEndDate')?.touched)">
                          <label *ngIf="form.get('projectEndDate')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <multifile-upload formControlName="projectImgs" [label]="'Fotos'"
                          [maxFiles]="5"></multifile-upload>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="projectVideoUrl" [label]="'Url video'" />
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="projectState" [label]="'Estado'"
                          [options]="stateProjectList"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('projectState')?.invalid
                          && (form.get('projectState')?.dirty
                          || form.get('projectState')?.touched)">
                          <label *ngIf="form.get('projectState')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                  </div>
                </form>
                <div class="project-register-buttons-container" style="text-align: right;">
                  <button mat-button matStepperNext>Continuar</button>
                </div>
              </mat-step>
              <mat-step [stepControl]="form">
                <form [formGroup]="form" class="project-register-form">
                  <ng-template matStepLabel>Cultivo</ng-template>
                  <div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="cropCountry" [label]="'País'"
                          [options]="countryList"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('cropCountry')?.invalid
                          && (form.get('cropCountry')?.dirty
                          || form.get('cropCountry')?.touched)">
                          <label *ngIf="form.get('cropCountry')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="cropDepartment" [label]="'Departamento'"
                          [options]="deparmentList"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('cropDepartment')?.invalid
                          && (form.get('cropDepartment')?.dirty
                          || form.get('cropDepartment')?.touched)">
                          <label *ngIf="form.get('cropDepartment')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="cropCity" [label]="'Ciudad'"
                          [options]="cityList"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('cropCity')?.invalid
                          && (form.get('cropCity')?.dirty
                          || form.get('cropCity')?.touched)">
                          <label *ngIf="form.get('cropCity')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="cropAddress" [label]="'Direccion'" />
                        <mat-error class="error-field" *ngIf="form.get('cropCity')?.invalid
                        && (form.get('cropAddress')?.dirty
                        || form.get('cropAddress')?.touched)">
                          <label *ngIf="form.get('cropAddress')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="cropTypeGround" [label]="'Tipo de suelo'"
                          [options]="listTypeGround"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('cropCity')?.invalid
                          && (form.get('cropTypeGround')?.dirty
                          || form.get('cropTypeGround')?.touched)">
                          <label *ngIf="form.get('cropTypeGround')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="cropHetares" [label]="'Numero de hectareas'"
                          [sufix]="' Héctareas'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('cropHetares')?.invalid
                          && (form.get('cropHetares')?.dirty
                          || form.get('cropHetares')?.touched)">
                          <label *ngIf="form.get('cropHetares')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="cropNumberPlants" [label]="'Numero de plantas'"
                          [sufix]="' plantas'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('cropNumberPlants')?.invalid
                          && (form.get('cropNumberPlants')?.dirty
                          || form.get('cropNumberPlants')?.touched)">
                          <label *ngIf="form.get('cropNumberPlants')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="vegetativePeriod" [label]="'Periodo vegetativo'"
                          [sufix]="' Meses'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('vegetativePeriod')?.invalid
                          && (form.get('vegetativePeriod')?.dirty
                          || form.get('vegetativePeriod')?.touched)">
                          <label *ngIf="form.get('vegetativePeriod')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="productivePeriod" [label]="'Periodo productivo'"
                          [sufix]="' Meses'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('productivePeriod')?.invalid
                          && (form.get('productivePeriod')?.dirty
                          || form.get('productivePeriod')?.touched)">
                          <label *ngIf="form.get('productivePeriod')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="cropStartDate" [label]="'Fecha inicio del cultivo'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('cropStartDate')?.invalid
                        && (form.get('cropStartDate')?.dirty
                        || form.get('cropStartDate')?.touched)">
                          <label *ngIf="form.get('cropStartDate')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="cropEndDate" [label]="'Fecha estimada cosecha'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('cropEndDate')?.invalid
                        && (form.get('cropEndDate')?.dirty
                        || form.get('cropEndDate')?.touched)">
                          <label *ngIf="form.get('cropEndDate')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                  </div>
                </form>
                <div class="project-register-buttons-container">
                  <div class="row project-register-buttons-container">
                    <div class="col-md-6">
                      <button mat-button matStepperPrevious>Atras</button>
                    </div>
                    <div class="col-md-6" style="text-align: right;">
                      <button mat-button matStepperNext>Continuar</button>
                    </div>
                  </div>
                </div>
              </mat-step>
              <mat-step [stepControl]="form">
                <form [formGroup]="form" class="project-register-form">
                  <ng-template matStepLabel>Productor</ng-template>
                  <div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="producerTypeId" [label]="'Tipo identificación'"
                          [options]="listTypeIdentification"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('producerTypeId')?.invalid
                          && (form.get('producerTypeId')?.dirty
                          || form.get('producerTypeId')?.touched)">
                          <label *ngIf="form.get('producerTypeId')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="producerIdValue" [label]="'Identificación'" />
                        <mat-error class="error-field" *ngIf="form.get('producerIdValue')?.invalid
                        && (form.get('producerIdValue')?.dirty
                        || form.get('producerIdValue')?.touched)">
                          <label *ngIf="form.get('producerIdValue')?.hasError('required')">El campo es
                            obligatorio</label>
                          <label *ngIf="form.get('producerIdValue')?.hasError('minlength')">El campo tiene menos de 7
                            numeros</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="croExpeditionCity" [label]="'Ciudad expedición dni'"
                          [options]="cityList"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('croExpeditionCity')?.invalid
                          && (form.get('croExpeditionCity')?.dirty
                          || form.get('croExpeditionCity')?.touched)">
                          <label *ngIf="form.get('croExpeditionCity')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="producerName" [label]="'Nombre'" />
                        <mat-error class="error-field" *ngIf="form.get('producerName')?.invalid
                        && (form.get('producerName')?.dirty
                        || form.get('producerName')?.touched)">
                          <label *ngIf="form.get('producerName')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="producerMail" [label]="'Correo'" />
                        <mat-error class="error-field" *ngIf="form.get('producerMail')?.invalid
                        && (form.get('producerMail')?.dirty
                        || form.get('producerMail')?.touched)">
                          <label *ngIf="form.get('producerMail')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="producerPhone" [label]="'Telefono'" />
                        <mat-error class="error-field" *ngIf="form.get('producerPhone')?.invalid
                        && (form.get('producerPhone')?.dirty
                        || form.get('producerPhone')?.touched)">
                          <label>El campo es obligatorio</label>
                          <label *ngIf="form.get('producerPhone')?.hasError('minlength')">El campo tiene menos de 10
                            caracteres</label>
                          <label *ngIf="form.get('producerPhone')?.hasError('maxlength')">El campo tiene mas de 10
                            caracteres</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-text formControlName="producerAddress" [label]="'Dirección'" />
                        <mat-error class="error-field" *ngIf="form.get('producerAddress')?.invalid
                        && (form.get('producerAddress')?.dirty
                        || form.get('producerAddress')?.touched)">
                          <label *ngIf="form.get('producerAddress')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="producerBirthday" [label]="'Fecha de nacimiento'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('producerBirthday')?.invalid
                        && (form.get('producerBirthday')?.dirty
                        || form.get('producerBirthday')?.touched)">
                          <label *ngIf="form.get('producerBirthday')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <multifile-upload formControlName="producerImgProfile" [label]="'Foto de perfil'"
                          [maxFiles]="1"></multifile-upload>
                      </div>
                    </div>
                  </div>
                </form>
                <div>
                  <div class="project-register-buttons-container">
                    <div class="row project-register-buttons-container">
                      <div class="col-md-6">
                        <button mat-button matStepperPrevious>Atras</button>
                      </div>
                      <div class="col-md-6" style="text-align: right;">
                        <button mat-button matStepperNext>Continuar</button>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-step>
              <mat-step [stepControl]="form">
                <form [formGroup]="form" class="project-register-form">
                  <ng-template matStepLabel>Inversión</ng-template>
                  <div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="investmentRate" [label]="'Rate estimado'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('investmentRate')?.invalid
                        && (form.get('producerMail')?.dirty
                        || form.get('producerMail')?.touched)">
                          <label *ngIf="form.get('producerMail')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="investmentTir" [label]="'TIR'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('investmentTir')?.invalid
                        && (form.get('investmentTir')?.dirty
                        || form.get('investmentTir')?.touched)">
                          <label *ngIf="form.get('investmentTir')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="investmentMinAmount" [label]="'Minimo de inversion'"
                          [sufix]="' COP'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('investmentMinAmount')?.invalid
                          && (form.get('investmentMinAmount')?.dirty
                          || form.get('investmentMinAmount')?.touched)">
                          <label *ngIf="form.get('investmentMinAmount')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="investmentMaxAmount" [label]="'Maximo de inversion'"
                          [sufix]="' COP'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('investmentMaxAmount')?.invalid
                          && (form.get('investmentMaxAmount')?.dirty
                          || form.get('investmentMaxAmount')?.touched)">
                          <label *ngIf="form.get('investmentMaxAmount')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="investmentTargetAmount" [label]="'Meta de inversión'"
                          [sufix]="' COP'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('investmentTargetAmount')?.invalid
                          && (form.get('investmentTargetAmount')?.dirty
                          || form.get('investmentTargetAmount')?.touched)">
                          <label *ngIf="form.get('investmentTargetAmount')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="investmentStartDate" [label]="'Fecha inicio'"></input-date>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="investmentEndDate" [label]="'Fecha fin'"></input-date>
                      </div>
                    </div>
                  </div>
                </form>
                <div class="project-register-buttons-container">
                  <div class="row project-register-buttons-container">
                    <div class="col-md-6">
                      <button mat-button matStepperPrevious>Atras</button>
                    </div>
                    <div class="col-md-6" style="text-align: right;">
                      <button *ngIf="showPrePurchaseForm" mat-button matStepperNext>Continuar</button>
                      <button *ngIf="!showPrePurchaseForm" mat-button [disabled]="form.invalid"
                        (click)="saveProject()">{{isEdit ?
                        'Actualizar':'Crear'}}</button>
                    </div>
                  </div>
                </div>
              </mat-step>
              <mat-step *ngIf="showPrePurchaseForm" [stepControl]="form">
                <form [formGroup]="form" class="project-register-form">
                  <ng-template matStepLabel>Pre-Orden</ng-template>
                  <div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-list-option formControlName="prePurchaseUnit" [label]="'Unidad'"
                          [options]="listTypePreOrders"></input-list-option>
                        <mat-error class="error-field" *ngIf="form.get('prePurchaseUnit')?.invalid
                          && (form.get('prePurchaseUnit')?.dirty
                          || form.get('prePurchaseUnit')?.touched)">
                          <label *ngIf="form.get('prePurchaseUnit')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="prePurchaseMinAmount" [label]="'Pre-compra minima'"
                          [sufix]="preOrderUnit"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('prePurchaseMinAmount')?.invalid
                          && (form.get('prePurchaseMinAmount')?.dirty
                          || form.get('prePurchaseMinAmount')?.touched)">
                          <label *ngIf="form.get('prePurchaseMinAmount')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="prePurchaseMaxAmount" [label]="'Pre-compra maxima'"
                          [sufix]="preOrderUnit"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('prePurchaseMaxAmount')?.invalid
                          && (form.get('prePurchaseMaxAmount')?.dirty
                          || form.get('prePurchaseMaxAmount')?.touched)">
                          <label *ngIf="form.get('prePurchaseMaxAmount')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="totalPrePurcharse" [label]="'Total pre-compra'"
                          [sufix]="preOrderUnit"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('totalPrePurcharse')?.invalid
                          && (form.get('totalPrePurcharse')?.dirty
                          || form.get('totalPrePurcharse')?.touched)">
                          <label *ngIf="form.get('totalPrePurcharse')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <app-input-number formControlName="prepurchaseUnitPrice" [label]="'Precio unidad'"
                          [sufix]="'COP'"></app-input-number>
                        <mat-error class="error-field" *ngIf="form.get('prepurchaseUnitPrice')?.invalid
                          && (form.get('prepurchaseUnitPrice')?.dirty
                          || form.get('prepurchaseUnitPrice')?.touched)">
                          <label *ngIf="form.get('prepurchaseUnitPrice')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="prePurchaseStartDate" [label]="'Fecha inicio'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('prePurchaseStartDate')?.invalid
                        && (form.get('prePurchaseStartDate')?.dirty
                        || form.get('prePurchaseStartDate')?.touched)">
                          <label *ngIf="form.get('prePurchaseStartDate')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12">
                        <input-date formControlName="prePurchaseEndDate" [label]="'Fecha fin'"></input-date>
                        <mat-error class="error-field" *ngIf="form.get('prePurchaseEndDate')?.invalid
                        && (form.get('prePurchaseEndDate')?.dirty
                        || form.get('prePurchaseEndDate')?.touched)">
                          <label *ngIf="form.get('prePurchaseEndDate')?.hasError('required')">El campo es
                            obligatorio</label>
                        </mat-error>
                      </div>
                    </div>
                  </div>
                </form>
                <div class="project-register-buttons-container">
                  <div class="row project-register-buttons-container">
                    <div class="col-md-6">
                      <button mat-button matStepperPrevious>Atras</button>
                    </div>
                    <div class="col-md-6" style="text-align: right;">
                      <button mat-button [disabled]="form.invalid" (click)="saveProject()">{{isEdit ?
                        'Actualizar':'Crear'}}</button>
                    </div>
                  </div>
                </div>
              </mat-step>
            </mat-stepper>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<p-confirmDialog [visible]="false" />
